<html lang="nb">
    <head>
        <title>SVG Recolor</title>
        <meta name="description" content="Easily recolor SVG icons! Pick a color, select an icon, and edit effortlessly. Perfect for mono- or multi-colored icons, logos, illustrations, and much more!">
        <meta name="keywords" content="svg, recolor, colorize, icons, images, graphics, tint, rgb, hex, color edit, python, fastapi, soloproject, svg editing">
        <meta name="author" content="Snailedlt">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">

        <!-- Favicon -->
        <link rel="icon" type="image/png" href="/static/favicon/favicon-96x96.png" sizes="96x96" />
        <link rel="icon" type="image/svg+xml" href="/static/favicon/favicon.svg" />
        <link rel="shortcut icon" href="/static/favicon/favicon.ico" />
        <link rel="apple-touch-icon" sizes="180x180" href="/static/favicon/apple-touch-icon.png" />
        <meta name="apple-mobile-web-app-title" content="SVG Recolor" />
        <link rel="manifest" href="/static/favicon/site.webmanifest" />

        <!-- Facebook Meta Tags -->
        <meta property="og:url" content="https://svg-recolor.jorgenkh.no/">
        <meta property="og:type" content="website">
        <meta property="og:title" content="SVG Recolor">
        <meta property="og:description" content="Easily recolor SVG icons! Pick a color, select an icon, and edit effortlessly. Perfect for mono- or multi-colored icons, logos, illustrations, and much more!">
        <meta property="og:image" content="https://svg-recolor.jorgenkh.no/static/thumbnail.jpg">

        <!-- Twitter Meta Tags -->
        <meta name="twitter:card" content="summary_large_image">
        <meta property="twitter:domain" content="svg-recolor.jorgenkh.no">
        <meta property="twitter:url" content="https://svg-recolor.jorgenkh.no/">
        <meta name="twitter:title" content="SVG Recolor">
        <meta name="twitter:description" content="Easily recolor SVG icons! Pick a color, select an icon, and edit effortlessly. Perfect for mono- or multi-colored icons, logos, illustrations, and much more!">
        <meta name="twitter:image" content="https://svg-recolor.jorgenkh.no/static/thumbnail.jpg">

        <style>
            body {
                font-family: 'Roboto', sans-serif;
                background: linear-gradient(135deg, #1e1e1e 0%, #2c2c2c 100%);
                color: #d4d4d4;
                margin: 0;
                padding: 0;
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                min-height: 100vh;
                animation: fadeIn 1s ease-in-out;
            }
            .top-links {
                position: absolute;
                top: 10px;
                right: 10px;
                display: flex;
                flex-direction: column;
                gap: 10px;
                background-color: #252526;
                padding: 10px;
                border-radius: 8px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
            }

            .links-title {
                color: #d4d4d4;
                font-size: 1.2em;
                margin: 0;
                padding-bottom: 5px;
                border-bottom: 1px solid #3c3c3c;
            }

            .top-links a {
                color: #569cd6;
                text-decoration: none;
                transition: color 0.3s ease;
                display: flex;
                align-items: center;
                padding: 5px;
                border-radius: 4px;
            }

            .top-links a:hover {
                color: #4a8bb1;
                background-color: #1e1e1e;
            }

            .top-links img {
                width: 20px;
                height: 20px;
                margin-right: 5px;
            }
            main {
                display: flex;
                flex-direction: column;
                align-items: center;
                justify-content: center;
                width: 100%;
                max-width: 800px;
                padding: 20px;
            }
            @keyframes fadeIn {
                from { opacity: 0; }
                to { opacity: 1; }
            }
            h1 {
                color: #569cd6;
                margin-bottom: 20px;
                font-size: 2.5em;
                animation: slideIn 1s ease-in-out;
            }
            @keyframes slideIn {
                from { transform: translateY(-50px); opacity: 0; }
                to { transform: translateY(0); opacity: 1; }
            }
            form {
                background-color: #252526;
                padding: 20px;
                border-radius: 8px;
                box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
                display: flex;
                flex-direction: column;
                align-items: center;
                width: 100%;
                max-width: 400px;
                animation: popIn 0.5s ease-in-out;
            }
            @keyframes popIn {
                from { transform: scale(0.8); opacity: 0; }
                to { transform: scale(1); opacity: 1; }
            }
            input[type="file"],
            input[type="text"],
            button {
                width: 100%;
                padding: 10px;
                margin: 10px 0;
                border-radius: 4px;
                border: 1px solid #3c3c3c;
                font-size: 16px;
                transition: all 0.3s ease;
                background-color: #1e1e1e;
                color: #d4d4d4;
            }
            input[type="file"]:focus,
            input[type="text"]:focus {
                border-color: #569cd6;
                box-shadow: 0 0 5px rgba(86, 156, 214, 0.5);
                outline: none;
            }
            button {
                background-color: #569cd6;
                border: none;
                cursor: pointer;
                color:#1e1e1e;
                transition: background-color 0.3s ease, transform 0.3s ease;
                font-weight:bold;
            }
            button:hover {
                background-color: #4a8bb1;
                transform: translateY(-2px);
            }
            .preview {
                display: flex;
                flex-direction: column;
                align-items: center;
                margin-top: 20px;
                width: 100%;
                max-width: 400px;
            }
            .preview h2 {
                margin: 10px 0;
                font-size: 1.5em;
                animation: fadeIn 1s ease-in-out;
            }
            .container {
                border: 1px solid #3c3c3c;
                padding: 10px;
                margin-top: 10px;
                width: 100%;
                max-width: 300px;
                background-color: #252526;
                border-radius: 8px;
                box-shadow: 0 0 10px rgba(0, 0, 0, 0.5);
                animation: popIn 0.5s ease-in-out;
            }
            .error {
                color: #f66;
                margin: 10px 0;
                animation: shake 0.5s ease-in-out;
            }
            @keyframes shake {
                0%, 100% { transform: translateX(0); }
                25% { transform: translateX(-5px); }
                50% { transform: translateX(5px); }
                75% { transform: translateX(-5px); }
            }
            .glorious-label {
                font-size: 1.2em;
                font-weight: bold;
                color: #569cd6;
                margin-bottom: 5px;
                display: block;
                text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.5);
                transition: color 0.3s ease;
            }

            .glorious-label:hover {
                color: #4a8bb1;
            }
        </style>
    </head>
    <body>
        <div class="top-links">
            <h2 class="links-title">Resources</h2>
            <a href="/docs" target="_blank">
                <img src="https://cdn.jsdelivr.net/gh/devicons/devicon@latest/icons/swagger/swagger-original.svg" alt="Swagger">
                API Docs (Swagger)
            </a>
            <a href="/redoc" target="_blank">
                <img src="static/redoc.svg" alt="Redoc">
                API Docs (Redoc)
            </a>
            <a href="https://github.com/Snailedlt/svg-recolor" target="_blank">
                <img src="https://deviconapi.vercel.app/github?theme=dark&size=128" alt="GitHub">
                GitHub Repo
            </a>
            <a href="https://jorgenkh.no" target="_blank" >
                <img src="/static/avatar.png" alt="JorgenKH">
                My Portfolio
            </a>
            <script type='text/javascript' src='https://storage.ko-fi.com/cdn/widget/Widget_2.js'></script><script type='text/javascript'>kofiwidget2.init('Support me on Ko-fi', '#252526', 'H2H0GY0OU');kofiwidget2.draw();</script> 
        </div>
        <main>
            <h1>SVG Recolor</h1>
            <form id="colorize-form" action="/colorize" method="post" enctype="multipart/form-data">

                <label for="files" class="glorious-label">Upload SVG Icon:</label>
                <input id="files" type="file" name="icon" accept="image/svg+xml" onchange="openFile(event)">

                <label for="color-input" class="glorious-label">Choose Color:</label>
                <input id="color-input" type="color" name="color" value="#FF0066">

                <button type="submit">Colorize</button>
                <div id="error-message" class="error"></div>
            </form>
            <div class="preview">
                <h2>Input Image Preview</h2>
                <div id="preview-container" class="container"></div>
                <h2>Output Image Preview</h2>
                <div id="result-container" class="container"></div>
            </div>
        </main>
        <script>
            const previewIconStyles = `
                <style>
                    svg {
                        max-width: 100%;
                        max-height: 400px;
                        width: auto;
                        height: auto;
                    }
                </style>
            `;
            function validateColor(color) {
                const hexColorPattern = /^#[a-fA-F0-9]{6}$/;
                const rgbColorPattern = /^(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9]),(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9]),(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[1-9]?[0-9])$/;
                return hexColorPattern.test(color) || rgbColorPattern.test(color);
            }

            function openFile(event) {
                read(event.target);
            }

            function read(input) {
                if (input.files && input.files[0]) {
                    const file = input.files[0];
                    const reader = new FileReader();
                    reader.onload = () => {
                        const previewContainer = document.getElementById('preview-container');
                        if (!previewContainer.shadowRoot) {
                            const shadow = previewContainer.attachShadow({ mode: 'open' });
                            shadow.innerHTML = `
                                ${previewIconStyles}
                                ${reader.result}
                            `;
                        } else {
                            previewContainer.shadowRoot.innerHTML = `
                                ${previewIconStyles}
                                ${reader.result}
                            `;
                        }
                    };
                    reader.readAsText(file);
                }
            }

            document.getElementById('colorize-form').addEventListener('submit', function(event) {
                event.preventDefault();
                const colorInput = document.getElementById('color-input');
                const color = colorInput.value;
                const errorMessage = document.getElementById('error-message');
                const fileInput = document.getElementById('files');
                const file = fileInput.files[0];

                if (!file) {
                    errorMessage.textContent = 'Please upload a valid SVG file.';
                    return;
                }

                if (!validateColor(color)) {
                    errorMessage.textContent = 'Invalid color format. Please use a hex color (e.g., #FF0066) or an RGB color (e.g., 255,0,102).';
                    return;
                }

                errorMessage.textContent = '';
                const formData = new FormData(this);
                fetch(`/colorize?color=${encodeURIComponent(color)}`, {
                    method: 'POST',
                    body: formData
                })
                .then(async response => {
                    if (!response.ok) {
                        const res = await response.text();
                        console.log(res);
                        const json = JSON.parse(res);
                        throw new Error(`${response.status} - ${response.statusText} - ${json.detail}`);
                    }
                    return response.text();
                })
                .then(data => {
                    const resultContainer = document.getElementById('result-container');
                    if (!resultContainer.shadowRoot) {
                        const shadow = resultContainer.attachShadow({ mode: 'open' });
                        shadow.innerHTML = `
                            ${previewIconStyles}
                            ${data}
                        `;
                    } else {
                        resultContainer.shadowRoot.innerHTML = `
                            ${previewIconStyles}
                            ${data}
                        `;
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    errorMessage.textContent = `Error: ${error.message}`;
                });
            });
        </script>
    </body>
</html>
